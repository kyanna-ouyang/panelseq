# index reference genome (e.g. GRCh38)
bsub -q verylong -R "rusage[mem=50G]" "/software/samtools/1.9/bin/samtools faidx GRCh38.primary_assembly.genome.fa"

# convert SAM files (bwa outputs) to BAM
while read i;
do
	/software/samtools/1.9/bin/samtools view -S -b ${i}.aln-pe.sam > ${i}.aln-pe.bam
done <samples.txt

# sort normal sample BAM file
/software/samtools/1.9/bin/samtools sort EL8N-blood_S10_L001.aln-pe.bam -o EL8N-blood_S10_L001.aln-pe.sorted.bam

# sort tumour samples BAM files
while read i;
do
	/software/samtools/1.9/bin/samtools sort ${i}.aln-pe.bam -o ${i}.aln-pe.sorted.bam
done <samples.txt

# index normal sample BAM file
/software/samtools/1.9/bin/samtools index EL8N-blood_S10_L001.aln-pe.sorted.bam EL8N-blood_S10_L001.aln-pe.sorted.bam.bai

# index tumour samples BAM files
while read i;
do
	/software/samtools/1.9/bin/samtools index ${i}.aln-pe.sorted.bam ${i}.aln-pe.sorted.bam.bai
done <samples.txt
